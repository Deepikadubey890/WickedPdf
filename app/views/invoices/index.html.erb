<!-- app/views/invoices/index.html.erb -->

<h1>All Invoices</h1>

<%= link_to 'New Invoice', new_invoice_path, class: 'btn btn-warning' %>

<%= search_form_for @q do |f| %>
  <%= f.label :full_name_cont %>
  <%= f.search_field :full_name_cont %>
  <%= f.submit %>
<% end %>


<%= sort_link @q, :messages_count, 'Popular' %>
<%= sort_link @q, :created_at, 'Fresh' %>

<%= link_to 'Clear search', request.path if request.query_parameters.any? %>


<div class="card mb-4">
<table class="table table-bordered border-primary table-hover ">
  <thead>
    <tr>
      <th>Invoice ID</th>
       <th>Full_name</th>
       <th>Address</th>
       <th>Email</th>
       <th>Phone</th>
      <th>Status</th>
      <th>PDF FILE</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @invoices.each do |invoice| %>
      <tr>
        <td class="table-primary"><%= invoice.id %></td>
      	<td class="table-secondary"><%= invoice.full_name %></td>
      	<td class="table-info"><%= invoice.address %></td>
      	<td class="table-danger"><%= invoice.email %></td>
      	<td class="table-secondary"><%= invoice.phone %></td>
        <td class="table-warning"><%= invoice.status %></td>

        <td>
            <% if invoice.pdf_file.attached? %>
                <iframe src="<%= rails_blob_path(invoice.pdf_file, disposition: 'inline') %>" width="100" height="80" frameborder="0"></iframe>

            <% else %>
              No PDF file attached
            <% end %>
        </td>

        <td>
          <%= link_to 'View', invoice_path(invoice),class: 'btn btn-danger' %>
          <%= link_to 'Download PDF', invoice_path(invoice, format: :pdf),class: 'btn btn-secondary' %>
          <!-- Add more actions if needed -->
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<div class="d-flex justify-content-center"><%= pagy_bootstrap_nav(@pagy).html_safe %></div>

</div>
